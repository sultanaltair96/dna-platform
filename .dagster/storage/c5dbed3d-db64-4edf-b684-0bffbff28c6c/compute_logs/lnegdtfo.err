2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - LOGS_CAPTURED - Started capturing logs in process (pid: 36347).
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - run_gold_agent_performance - STEP_START - Started execution of step "run_gold_agent_performance".
2026-02-18 20:35:37,301 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2026-02-18 20:35:37,301 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - run_gold_agent_performance - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_clean_agents using PickledObjectFilesystemIOManager...
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - run_gold_agent_performance - LOADED_INPUT - Loaded input "run_silver_clean_agents" using input manager "io_manager", from output "result" of step "run_silver_clean_agents"
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - run_gold_agent_performance - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_clean_claims using PickledObjectFilesystemIOManager...
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - run_gold_agent_performance - LOADED_INPUT - Loaded input "run_silver_clean_claims" using input manager "io_manager", from output "result" of step "run_silver_clean_claims"
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - run_gold_agent_performance - STEP_INPUT - Got input "run_silver_clean_agents" of type "Any". (Type check passed).
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - run_gold_agent_performance - STEP_INPUT - Got input "run_silver_clean_claims" of type "Any". (Type check passed).
2026-02-18 20:35:37,342 - src.core.utils - INFO - Starting operation: gold agent performance aggregation
2026-02-18 20:35:37,343 - src.core.gold_agent_performance - INFO - Starting gold agent performance aggregation
2026-02-18 20:35:37,343 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_agents_' using adls backend
2026-02-18 20:35:37,437 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '002e9252-0d01-11f1-a47c-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:38,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e6d0e722-a01f-0019-690d-a1ba8a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '002e9252-0d01-11f1-a47c-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:38 GMT'
2026-02-18 20:35:38,713 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_agents_20260218T193535Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '00f13cbc-0d01-11f1-a47c-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:40,244 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '6478'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:35 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24E35827C4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '15ae5aaa-301e-001b-0e0d-a10432000000'
    'x-ms-client-request-id': '00f13cbc-0d01-11f1-a47c-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:35:39 GMT'
2026-02-18 20:35:40,253 - src.core.storage - INFO - Successfully read 20 rows from ADLS: dna-platform/data/silver/silver_clean_agents_20260218T193535Z.parquet
2026-02-18 20:35:40,254 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_policies_' using adls backend
2026-02-18 20:35:40,257 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '01dcc15a-0d01-11f1-a47c-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:41,847 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6bca48e7-201f-0075-590d-a1511d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '01dcc15a-0d01-11f1-a47c-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:41 GMT'
2026-02-18 20:35:41,851 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_policies_20260218T193535Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '02cff776-0d01-11f1-a47c-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,055 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '9385'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:35 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24E358A158"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e9abfda5-f01e-003b-440d-a17f95000000'
    'x-ms-client-request-id': '02cff776-0d01-11f1-a47c-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:35:41 GMT'
2026-02-18 20:35:42,056 - src.core.storage - INFO - Successfully read 80 rows from ADLS: dna-platform/data/silver/silver_clean_policies_20260218T193535Z.parquet
2026-02-18 20:35:42,056 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_claims_' using adls backend
2026-02-18 20:35:42,057 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '02ef823a-0d01-11f1-a47c-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,229 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6df49598-701f-0025-460d-a1934d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '02ef823a-0d01-11f1-a47c-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:41 GMT'
2026-02-18 20:35:42,230 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_claims_20260218T193535Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0309dd4c-0d01-11f1-a47c-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,376 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '7823'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:35 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24E380B890"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '57118745-701e-0068-7c0d-a15ca1000000'
    'x-ms-client-request-id': '0309dd4c-0d01-11f1-a47c-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:35:42 GMT'
2026-02-18 20:35:42,377 - src.core.storage - INFO - Successfully read 30 rows from ADLS: dna-platform/data/silver/silver_clean_claims_20260218T193535Z.parquet
2026-02-18 20:35:42,377 - src.core.utils - INFO - Silver agents input: 20 rows, 13 columns
2026-02-18 20:35:42,377 - src.core.utils - INFO - Silver policies input: 80 rows, 14 columns
2026-02-18 20:35:42,377 - src.core.utils - INFO - Silver claims input: 30 rows, 12 columns
2026-02-18 20:35:42,383 - src.core.utils - ERROR - Operation 'gold agent performance aggregation' failed after 5.04 seconds: cannot cast List type (inner: 'UInt32', to: 'Int32')
2026-02-18 20:35:42 +0100 - dagster - ERROR - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36347 - run_gold_agent_performance - STEP_FAILURE - Execution of step "run_gold_agent_performance" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "run_gold_agent_performance"::

polars.exceptions.InvalidOperationError: cannot cast List type (inner: 'UInt32', to: 'Int32')

Stack Trace:
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
        fn, context, kwargs, context_arg_provided, config_arg_class, resource_arg_mapping
    )
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
                                                                    ~~^^^^^^^^^^^^^^^^
  File "/Users/taniskarigar/test-polster/dna-platform/src/orchestration/assets/gold/run_gold_agent_performance.py", line 18, in run_gold_agent_performance
    gold_path, df, metadata = aggregate()
                              ~~~~~~~~~^^
  File "/Users/taniskarigar/test-polster/dna-platform/src/core/gold_agent_performance.py", line 62, in aggregate
    result = result.with_columns(
        [
            pl.col("policies_with_claims").cast(pl.Int32),
        ]
    )
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/polars/dataframe/frame.py", line 10473, in with_columns
    .collect(optimizations=QueryOptFlags._eager())
     ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/polars/_utils/deprecation.py", line 97, in wrapper
    return function(*args, **kwargs)
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/polars/lazyframe/opt_flags.py", line 326, in wrapper
    return function(*args, **kwargs)
  File "/Users/taniskarigar/test-polster/dna-platform/.venv/lib/python3.14/site-packages/polars/lazyframe/frame.py", line 2440, in collect
    return wrap_df(ldf.collect(engine, callback))
                   ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^

