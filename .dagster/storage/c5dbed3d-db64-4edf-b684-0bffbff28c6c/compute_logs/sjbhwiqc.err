2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - LOGS_CAPTURED - Started capturing logs in process (pid: 36350).
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - STEP_START - Started execution of step "run_gold_premium_revenue".
2026-02-18 20:35:37,386 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2026-02-18 20:35:37,387 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - run_gold_premium_revenue - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_clean_payments using PickledObjectFilesystemIOManager...
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - LOADED_INPUT - Loaded input "run_silver_clean_payments" using input manager "io_manager", from output "result" of step "run_silver_clean_payments"
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - run_gold_premium_revenue - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_clean_policies using PickledObjectFilesystemIOManager...
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - LOADED_INPUT - Loaded input "run_silver_clean_policies" using input manager "io_manager", from output "result" of step "run_silver_clean_policies"
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - STEP_INPUT - Got input "run_silver_clean_payments" of type "Any". (Type check passed).
2026-02-18 20:35:37 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - STEP_INPUT - Got input "run_silver_clean_policies" of type "Any". (Type check passed).
2026-02-18 20:35:37,421 - src.core.utils - INFO - Starting operation: gold premium revenue aggregation
2026-02-18 20:35:37,421 - src.core.gold_premium_revenue - INFO - Starting gold premium revenue aggregation
2026-02-18 20:35:37,421 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_policies_' using adls backend
2026-02-18 20:35:37,504 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0038b6a6-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:38,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f89dd197-b01f-0067-620d-a12acd000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '0038b6a6-0d01-11f1-b2ef-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:37 GMT'
2026-02-18 20:35:38,713 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_policies_20260218T193535Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '00f13050-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:40,255 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '9385'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:35 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24E358A158"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '91c2821b-d01e-0071-4d0d-a1dc1a000000'
    'x-ms-client-request-id': '00f13050-0d01-11f1-b2ef-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:35:40 GMT'
2026-02-18 20:35:40,263 - src.core.storage - INFO - Successfully read 80 rows from ADLS: dna-platform/data/silver/silver_clean_policies_20260218T193535Z.parquet
2026-02-18 20:35:40,265 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_payments_' using adls backend
2026-02-18 20:35:40,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '01de37e2-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:41,845 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '69a366c2-201f-005a-740d-a15cd6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '01de37e2-0d01-11f1-b2ef-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:41 GMT'
2026-02-18 20:35:41,849 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_payments_20260218T193535Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '02cfc6a2-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,029 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '8595'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:35 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24E37FD3B0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0d74d11b-901e-002d-7f0d-a18942000000'
    'x-ms-client-request-id': '02cfc6a2-0d01-11f1-b2ef-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:35:41 GMT'
2026-02-18 20:35:42,030 - src.core.storage - INFO - Successfully read 100 rows from ADLS: dna-platform/data/silver/silver_clean_payments_20260218T193535Z.parquet
2026-02-18 20:35:42,030 - src.core.utils - INFO - Silver policies input: 80 rows, 14 columns
2026-02-18 20:35:42,031 - src.core.utils - INFO - Silver payments input: 100 rows, 11 columns
2026-02-18 20:35:42,042 - src.core.utils - INFO - Gold premium revenue output: 4 rows, 7 columns
2026-02-18 20:35:42,042 - src.core.storage - INFO - Writing DataFrame to gold/gold_premium_revenue_20260218T193542Z.parquet using adls backend
2026-02-18 20:35:42,042 - src.core.storage - INFO - Writing DataFrame (4 rows, 8 columns) to ADLS: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet
2026-02-18 20:35:42,044 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data?restype=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '02ed7c1a-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,224 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 18 Feb 2026 19:12:05 GMT'
    'ETag': '"0x8DE6F219B11A707"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c0650806-a01e-0019-610d-a1ba8a000000'
    'x-ms-client-request-id': '02ed7c1a-0d01-11f1-b2ef-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-has-immutability-policy': 'REDACTED'
    'x-ms-has-legal-hold': 'REDACTED'
    'x-ms-immutable-storage-with-versioning-enabled': 'REDACTED'
    'x-ms-default-encryption-scope': 'REDACTED'
    'x-ms-deny-encryption-scope-override': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:35:42 GMT'
2026-02-18 20:35:42,225 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '030911b4-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,380 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'ETag': '"0x8DE6F24E75F01A8"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a65e66be-701f-001a-6c0d-a15bee000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '030911b4-0d01-11f1-b2ef-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'Content-Length': '0'
2026-02-18 20:35:42,381 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0320ea5a-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,421 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'ETag': '"0x8DE6F24E76532C4"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a65e66c6-701f-001a-740d-a15bee000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '0320ea5a-0d01-11f1-b2ef-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'Content-Length': '0'
2026-02-18 20:35:42,421 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '3261'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '03270a48-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-18 20:35:42,456 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a65e66ce-701f-001a-7c0d-a15bee000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '03270a48-0d01-11f1-b2ef-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'Content-Length': '0'
2026-02-18 20:35:42,457 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE6F24E76532C4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '032c74ce-0d01-11f1-b2ef-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:35:42,518 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'ETag': '"0x8DE6F24E7743D94"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a65e66d4-701f-001a-020d-a15bee000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '032c74ce-0d01-11f1-b2ef-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:35:42 GMT'
    'Content-Length': '0'
2026-02-18 20:35:42,519 - src.core.storage - INFO - Successfully uploaded 0 bytes to ADLS: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet
2026-02-18 20:35:42,520 - src.core.storage - INFO - ADLS write successful: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet
2026-02-18 20:35:42,521 - src.core.storage - INFO - Successfully wrote 4 rows to local storage: /Users/taniskarigar/test-polster/dna-platform/data/gold/sample_gold_premium_revenue_20260218T193542Z.parquet
2026-02-18 20:35:42,521 - src.core.gold_premium_revenue - INFO - Gold premium revenue aggregation completed: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193542Z.parquet
2026-02-18 20:35:42,521 - src.core.utils - INFO - Completed operation 'gold premium revenue aggregation' in 5.10 seconds
2026-02-18 20:35:42 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-18 20:35:42 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - run_gold_premium_revenue - Writing file at: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_gold_premium_revenue using PickledObjectFilesystemIOManager...
2026-02-18 20:35:42 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - ASSET_MATERIALIZATION - Materialized value run_gold_premium_revenue.
2026-02-18 20:35:42 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
2026-02-18 20:35:42 +0100 - dagster - DEBUG - __ASSET_JOB - c5dbed3d-db64-4edf-b684-0bffbff28c6c - 36350 - run_gold_premium_revenue - STEP_SUCCESS - Finished execution of step "run_gold_premium_revenue" in 5.18s.
