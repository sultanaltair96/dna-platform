2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - LOGS_CAPTURED - Started capturing logs in process (pid: 29522).
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - STEP_START - Started execution of step "run_gold_customer_risk".
2026-02-18 20:33:54,614 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2026-02-18 20:33:54,614 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - run_gold_customer_risk - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_customer_policies using PickledObjectFilesystemIOManager...
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - LOADED_INPUT - Loaded input "run_silver_customer_policies" using input manager "io_manager", from output "result" of step "run_silver_customer_policies"
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - run_gold_customer_risk - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_policy_claims using PickledObjectFilesystemIOManager...
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - LOADED_INPUT - Loaded input "run_silver_policy_claims" using input manager "io_manager", from output "result" of step "run_silver_policy_claims"
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - STEP_INPUT - Got input "run_silver_customer_policies" of type "Any". (Type check passed).
2026-02-18 20:33:54 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - STEP_INPUT - Got input "run_silver_policy_claims" of type "Any". (Type check passed).
2026-02-18 20:33:54,651 - src.core.utils - INFO - Starting operation: gold customer risk aggregation
2026-02-18 20:33:54,651 - src.core.gold_customer_risk - INFO - Starting gold customer risk aggregation
2026-02-18 20:33:54,651 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_customer_policies_' using adls backend
2026-02-18 20:33:54,737 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c2f7c76e-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:54,888 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '66b22b77-f01f-0059-3c0d-a1bdb2000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c2f7c76e-0d00-11f1-ae1f-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:54 GMT'
2026-02-18 20:33:54,891 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_customer_policies_20260218T193352Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c30f433a-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '12260'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:53 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24A669CE20"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '467f4909-801e-006c-7b0d-a1d1a6000000'
    'x-ms-client-request-id': 'c30f433a-0d00-11f1-ae1f-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:33:54 GMT'
2026-02-18 20:33:55,058 - src.core.storage - INFO - Successfully read 6 rows from ADLS: dna-platform/data/silver/silver_customer_policies_20260218T193352Z.parquet
2026-02-18 20:33:55,058 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_policy_claims_' using adls backend
2026-02-18 20:33:55,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c328dc28-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,254 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f3a0cd10-b01f-0077-560d-a1efa5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c328dc28-0d00-11f1-ae1f-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:55 GMT'
2026-02-18 20:33:55,257 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_policy_claims_20260218T193352Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c347091e-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,436 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '14843'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:53 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24A66C0288"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ed6788e2-e01e-0045-6c0d-a1efd2000000'
    'x-ms-client-request-id': 'c347091e-0d00-11f1-ae1f-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:33:54 GMT'
2026-02-18 20:33:55,440 - src.core.storage - INFO - Successfully read 80 rows from ADLS: dna-platform/data/silver/silver_policy_claims_20260218T193352Z.parquet
2026-02-18 20:33:55,441 - src.core.utils - INFO - Silver customer-policies input: 6 rows, 29 columns
2026-02-18 20:33:55,441 - src.core.utils - INFO - Silver policy-claims input: 80 rows, 26 columns
2026-02-18 20:33:55,447 - src.core.utils - INFO - Gold customer risk output: 6 rows, 9 columns
2026-02-18 20:33:55,447 - src.core.storage - INFO - Writing DataFrame to gold/gold_customer_risk_20260218T193355Z.parquet using adls backend
2026-02-18 20:33:55,447 - src.core.storage - INFO - Writing DataFrame (6 rows, 10 columns) to ADLS: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet
2026-02-18 20:33:55,450 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data?restype=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3648f8e-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,608 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 18 Feb 2026 19:12:05 GMT'
    'ETag': '"0x8DE6F219B11A707"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0d730462-901e-002d-470d-a18942000000'
    'x-ms-client-request-id': 'c3648f8e-0d00-11f1-ae1f-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-has-immutability-policy': 'REDACTED'
    'x-ms-has-legal-hold': 'REDACTED'
    'x-ms-immutable-storage-with-versioning-enabled': 'REDACTED'
    'x-ms-default-encryption-scope': 'REDACTED'
    'x-ms-deny-encryption-scope-override': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:33:54 GMT'
2026-02-18 20:33:55,610 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c37cea5c-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,780 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'ETag': '"0x8DE6F24A7D4C488"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0aadf94a-101f-0033-470d-a1659a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c37cea5c-0d00-11f1-ae1f-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'Content-Length': '0'
2026-02-18 20:33:55,782 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3972da4-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,824 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'ETag': '"0x8DE6F24A7DB843C"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0aadf94d-101f-0033-4a0d-a1659a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c3972da4-0d00-11f1-ae1f-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'Content-Length': '0'
2026-02-18 20:33:55,826 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '3974'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c39ddd48-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-18 20:33:55,864 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0aadf94f-101f-0033-4c0d-a1659a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c39ddd48-0d00-11f1-ae1f-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'Content-Length': '0'
2026-02-18 20:33:55,865 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE6F24A7DB843C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3a3e83c-0d00-11f1-ae1f-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:55,930 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'ETag': '"0x8DE6F24A7EB9FC8"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0aadf951-101f-0033-4e0d-a1659a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c3a3e83c-0d00-11f1-ae1f-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:55 GMT'
    'Content-Length': '0'
2026-02-18 20:33:55,931 - src.core.storage - INFO - Successfully uploaded 0 bytes to ADLS: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet
2026-02-18 20:33:55,935 - src.core.storage - INFO - ADLS write successful: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet
2026-02-18 20:33:55,937 - src.core.storage - INFO - Successfully wrote 6 rows to local storage: /Users/taniskarigar/test-polster/dna-platform/data/gold/sample_gold_customer_risk_20260218T193355Z.parquet
2026-02-18 20:33:55,937 - src.core.gold_customer_risk - INFO - Gold customer risk aggregation completed: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_customer_risk_20260218T193355Z.parquet
2026-02-18 20:33:55,937 - src.core.utils - INFO - Completed operation 'gold customer risk aggregation' in 1.29 seconds
2026-02-18 20:33:55 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-18 20:33:55 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - run_gold_customer_risk - Writing file at: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_gold_customer_risk using PickledObjectFilesystemIOManager...
2026-02-18 20:33:55 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - ASSET_MATERIALIZATION - Materialized value run_gold_customer_risk.
2026-02-18 20:33:55 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
2026-02-18 20:33:55 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29522 - run_gold_customer_risk - STEP_SUCCESS - Finished execution of step "run_gold_customer_risk" in 1.36s.
