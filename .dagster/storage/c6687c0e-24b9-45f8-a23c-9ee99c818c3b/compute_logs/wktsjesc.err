2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - LOGS_CAPTURED - Started capturing logs in process (pid: 29483).
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - STEP_START - Started execution of step "run_gold_premium_revenue".
2026-02-18 20:33:51,299 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2026-02-18 20:33:51,299 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - run_gold_premium_revenue - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_clean_payments using PickledObjectFilesystemIOManager...
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - LOADED_INPUT - Loaded input "run_silver_clean_payments" using input manager "io_manager", from output "result" of step "run_silver_clean_payments"
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - run_gold_premium_revenue - Loading file from: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_silver_clean_policies using PickledObjectFilesystemIOManager...
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - LOADED_INPUT - Loaded input "run_silver_clean_policies" using input manager "io_manager", from output "result" of step "run_silver_clean_policies"
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - STEP_INPUT - Got input "run_silver_clean_payments" of type "Any". (Type check passed).
2026-02-18 20:33:51 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - STEP_INPUT - Got input "run_silver_clean_policies" of type "Any". (Type check passed).
2026-02-18 20:33:51,332 - src.core.utils - INFO - Starting operation: gold premium revenue aggregation
2026-02-18 20:33:51,332 - src.core.gold_premium_revenue - INFO - Starting gold premium revenue aggregation
2026-02-18 20:33:51,332 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_policies_' using adls backend
2026-02-18 20:33:51,412 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c0fc5bdc-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:51,999 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '02e80ac3-601f-0006-5b0d-a1098e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c0fc5bdc-0d00-11f1-9b5e-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:51 GMT'
2026-02-18 20:33:52,005 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_policies_20260218T193348Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c156c7c0-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:52,277 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '9338'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:49 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24A40A7720"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a471c17f-d01e-004e-6d0d-a114b9000000'
    'x-ms-client-request-id': 'c156c7c0-0d00-11f1-9b5e-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:33:51 GMT'
2026-02-18 20:33:52,288 - src.core.storage - INFO - Successfully read 80 rows from ADLS: dna-platform/data/silver/silver_clean_policies_20260218T193348Z.parquet
2026-02-18 20:33:52,289 - src.core.storage - INFO - Reading latest parquet file from silver layer with prefix 'silver_clean_payments_' using adls backend
2026-02-18 20:33:52,293 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data?resource=REDACTED&directory=REDACTED&recursive=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c182c3c0-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:52,730 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/json;charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '29c8c64d-901f-0060-560d-a146ae000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c182c3c0-0d00-11f1-9b5e-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
2026-02-18 20:33:52,733 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data/dna-platform/data/silver/silver_clean_payments_20260218T193348Z.parquet'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1c5fa32-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:52,919 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '8573'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:49 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE6F24A40B25BC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b618468a-e01e-0027-1a0d-a12df5000000'
    'x-ms-client-request-id': 'c1c5fa32-0d00-11f1-9b5e-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
2026-02-18 20:33:52,922 - src.core.storage - INFO - Successfully read 100 rows from ADLS: dna-platform/data/silver/silver_clean_payments_20260218T193348Z.parquet
2026-02-18 20:33:52,925 - src.core.utils - INFO - Silver policies input: 80 rows, 14 columns
2026-02-18 20:33:52,925 - src.core.utils - INFO - Silver payments input: 100 rows, 11 columns
2026-02-18 20:33:52,939 - src.core.utils - INFO - Gold premium revenue output: 3 rows, 7 columns
2026-02-18 20:33:52,939 - src.core.storage - INFO - Writing DataFrame to gold/gold_premium_revenue_20260218T193352Z.parquet using adls backend
2026-02-18 20:33:52,939 - src.core.storage - INFO - Writing DataFrame (3 rows, 8 columns) to ADLS: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet
2026-02-18 20:33:52,941 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.blob.core.windows.net/dna-platform-data?restype=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1e5c038-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:53,107 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 18 Feb 2026 19:12:05 GMT'
    'ETag': '"0x8DE6F219B11A707"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '60a6bda4-601e-004b-6f0d-a1c662000000'
    'x-ms-client-request-id': 'c1e5c038-0d00-11f1-9b5e-765227f64d11'
    'x-ms-version': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-has-immutability-policy': 'REDACTED'
    'x-ms-has-legal-hold': 'REDACTED'
    'x-ms-immutable-storage-with-versioning-enabled': 'REDACTED'
    'x-ms-default-encryption-scope': 'REDACTED'
    'x-ms-deny-encryption-scope-override': 'REDACTED'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
2026-02-18 20:33:53,108 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1ff3112-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:53,269 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:53 GMT'
    'ETag': '"0x8DE6F24A65615D8"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5811d5ce-a01f-006b-440d-a1bdc5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c1ff3112-0d00-11f1-9b5e-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
    'Content-Length': '0'
2026-02-18 20:33:53,270 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c217e2a2-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:53,320 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:53 GMT'
    'ETag': '"0x8DE6F24A65CD64C"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5811d5e0-a01f-006b-560d-a1bdc5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c217e2a2-0d00-11f1-9b5e-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
    'Content-Length': '0'
2026-02-18 20:33:53,321 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '3209'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c21f9d76-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-18 20:33:53,359 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5811d5e5-a01f-006b-5b0d-a1bdc5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c21f9d76-0d00-11f1-9b5e-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
    'Content-Length': '0'
2026-02-18 20:33:53,359 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://woningmarktintelx9.dfs.core.windows.net/dna-platform-data/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE6F24A65CD64C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.14.2 (macOS-15.6.1-arm64-arm-64bit-Mach-O)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c2258b96-0d00-11f1-9b5e-765227f64d11'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-18 20:33:53,422 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Last-Modified': 'Wed, 18 Feb 2026 19:33:53 GMT'
    'ETag': '"0x8DE6F24A66D480C"'
    'Server': 'Windows-Azure-HDFS/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5811d5e7-a01f-006b-5d0d-a1bdc5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c2258b96-0d00-11f1-9b5e-765227f64d11'
    'Date': 'Wed, 18 Feb 2026 19:33:52 GMT'
    'Content-Length': '0'
2026-02-18 20:33:53,423 - src.core.storage - INFO - Successfully uploaded 0 bytes to ADLS: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet
2026-02-18 20:33:53,424 - src.core.storage - INFO - ADLS write successful: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet
2026-02-18 20:33:53,425 - src.core.storage - INFO - Successfully wrote 3 rows to local storage: /Users/taniskarigar/test-polster/dna-platform/data/gold/sample_gold_premium_revenue_20260218T193352Z.parquet
2026-02-18 20:33:53,425 - src.core.gold_premium_revenue - INFO - Gold premium revenue aggregation completed: abfss://dna-platform-data@woningmarktintelx9.dfs.core.windows.net/dna-platform/data/gold/gold_premium_revenue_20260218T193352Z.parquet
2026-02-18 20:33:53,425 - src.core.utils - INFO - Completed operation 'gold premium revenue aggregation' in 2.09 seconds
2026-02-18 20:33:53 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-18 20:33:53 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - run_gold_premium_revenue - Writing file at: /Users/taniskarigar/test-polster/dna-platform/.dagster/storage/run_gold_premium_revenue using PickledObjectFilesystemIOManager...
2026-02-18 20:33:53 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - ASSET_MATERIALIZATION - Materialized value run_gold_premium_revenue.
2026-02-18 20:33:53 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
2026-02-18 20:33:53 +0100 - dagster - DEBUG - __ASSET_JOB - c6687c0e-24b9-45f8-a23c-9ee99c818c3b - 29483 - run_gold_premium_revenue - STEP_SUCCESS - Finished execution of step "run_gold_premium_revenue" in 2.16s.
